---
title: "Introduction to Visualizing and Summarizing Data"
author: Valeria Estrada
date: "Due: January 24, 2021 at 11:59pm"
output: html_document
---

<div style="color:blue">

Great job! You have revisions on problems: 

My comments for your responses to the exercises can be found in blue text, and my comments/suggestions for your R code can be found in the code chunks behind two hashtags (##)

Your homework assignment receives a score that reflects the average points-per-question, where each question is worth 4 points. This is assigned based on the grading system outlined in the syllabus. 

Problems marked with an “R” must be redone and returned within two days of receiving the assignment back. You will receive a score of 0 on each problem requiring a revision until a revision is submitted. Late revisions receive a zero, unless you contact me. Work successfully redone (on time) will receive a maximum grade of 3. It is possible to have a redo on a redo.

</div>


```{r, include = FALSE}
knitr::opts_chunk$set(echol = TRUE, 
                      results = "hold", 
                      message = FALSE, 
                      warning = FALSE)
```

## Getting started

### Load packages

In this lab, we will explore and visualize the data using the **tidyverse** suite of packages. The data can be found in the companion package for OpenIntro labs, **openintro**.

Let's load the following packages:

-   The **tidyverse** "umbrella" package which houses a suite of many different `R` packages: for data wrangling and data visualization
-   The **openintro** `R` package: for data and custom functions with the OpenIntro resources

```{r, include = FALSE}
library(tidyverse)
library(openintro)
## This is a comment -- R will not run this line as code, because it has ## before it
```

### The data

The [Bureau of Transportation Statistics](http://www.rita.dot.gov/bts/about/) (BTS) is a statistical agency that is a part of the Research and Innovative Technology Administration (RITA).
As its name implies, BTS collects and makes transportation data available, such as the flights data we will be working with in this lab.

First, we'll view the `nycflights` data frame.
Type the following in your console to load the data:

```{r}
data(nycflights)
```

The data set `nycflights` that shows up in your workspace is a *data matrix*, with each row representing an *observation* and each column representing a *variable*.
R calls this data format a **data frame**, which is a term that will be used throughout the labs.
For this data set, each *observation* is a single flight.

To view the names of the variables, you can use the `names()` function: 

```{r}
names(nycflights)
```

This returns the names of the variables in this data frame.
The **codebook** (description of the variables) can be accessed by pulling up the help file by typing a `?` before the name of the dataset:

```{r, eval = FALSE}
?nycflights
```

One of the variables refers to the carrier (i.e. airline) of the flight, which is coded according to the following system.

-   `carrier`: Two letter carrier abbreviation.

    -   `9E`: Endeavor Air Inc.
    -   `AA`: American Airlines Inc.
    -   `AS`: Alaska Airlines Inc.
    -   `B6`: JetBlue Airways
    -   `DL`: Delta Air Lines Inc.
    -   `EV`: ExpressJet Airlines Inc.
    -   `F9`: Frontier Airlines Inc.
    -   `FL`: AirTran Airways Corporation
    -   `HA`: Hawaiian Airlines Inc.
    -   `MQ`: Envoy Air
    -   `OO`: SkyWest Airlines Inc.
    -   `UA`: United Air Lines Inc.
    -   `US`: US Airways Inc.
    -   `VX`: Virgin America
    -   `WN`: Southwest Airlines Co.
    -   `YV`: Mesa Airlines Inc.

Remember that you can use `glimpse` to take a quick peek at your data to understand its contents better.

```{r}
glimpse(nycflights)
```

1. (a) How large is the `nycflights` dataset? (i.e. How many rows and columns does it have?)
<!-- Your response goes below this line! -->

Based on the glimpse function there are 32,735 rows and 16 columns.

<div style="color:blue">
Correct! 
</div>

1. (b) When were these data collected? 
<!-- Your response goes below this line! -->

Based on the integer year the data was collected in 2013.

<div style="color:blue">
Correct! Did you look at the help file? Did it tell you this information? 
</div>


1. (c) Are there categorical variables in the dataset? If so, what are their names and data types? 
<!-- Your response goes below this line! -->

There are many categorical variables in the nycflights dataset. The following categorical variables are integers: year, month, day, departure time, arrival time, and flight number. Where as carrier, tail number, origin and destination categorical variables are characters. 

<div style="color:blue">
Nice work! Keep in mind that if these variables were labeled a `fct` that would *also* be a categorical variable!  
</div>

<div style="color:blue">
Overall: 4
</div>


### Departure Delays

Let's start by examining the distribution of departure delays of all flights with a histogram.

```{r}
ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram()
```

This function says to plot the `dep_delay` variable from the `nycflights` data frame on the x-axis.
It also defines a `geom` (short for geometric object), which describes the type of plot you will produce.

Histograms are generally a very good way to see the shape of a single distribution of numerical data, but that shape can change depending on how the data is split between the different bins.
You can easily define the binwidth you want to use, by specifying the `binwidth` argument to `geom_histogram()`, like so:

```{r}
ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram(binwidth = 15)

ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram(binwidth = 150)
```

2.  Look carefully at these three histograms. How do they compare? Are features revealed in one that are obscured in another?
<!-- Your answer goes below this line -- do not remove this!  -->

All three histograms are the representing the same data, just in different ways, which is why some features do not appear in graphs like the other. For instance, in the binwidth=15 there is more detail than the original and the binwidth=150 histogram. To be more specific, there is a bar to the left of the highest bar, meaning there are observations within that departure delay. Also, there is a very small line to the right, which may represent possible outliers(however in order to concretely point out outliers we would have to use a different graph). Each of the graphs show that they are skewed to the right, but again the binwidth = 15 histogram does a better job of it. One unimportant feature to note is the y-axis. The y-axis, number of counts shows different heights depending on the binwidth. However, this is just an artifact of using the gglot2 in R.

<div style="color:blue">
Nice work! The smaller binwidth makes certain aspects of plot more visible. The y-axis is not simply an artifact of plotting with ggplot! What is happening to the counts of flights when we change the binwidth of our histogram?  
</div>

<div style="color:blue">
Overall: Redo
</div>

3. A histogram is only one way to visualize the distribution of a numerical variable. 
(a) What are other visualizations that we could have produced? 
(b) What are the benefits and weaknesses of a histogram compared to these other options? 
<!-- Your response goes below this line! -->

As stated above a histogram does not show outliers within the data because it does not show raw data point, but instead groups them. It is possible to use a dot plot to better visualize the findings, each dot represents an observation. Compared to a box plot and dotplot, histograms lack visualization of the outliers. Box plots also show the median and depending on the data show the min and max with the whiskers on either side of graph. There is also a density plot which is used more for large amounts of data and is essentially tracing a line over a histogram peak to make a mountain-like like over the data. The benefit of a histogram is the ease it may provide to its readers to identify a trend, such as if the observations are skewed left or right and the modal shape of the graph. However it is important to note the dot plots also show this level of visualization but also show each observation (so it can lead to some confusion). Another benefit is processing or showing large amounts of observations within one bar.

<div style="color:blue">
Good description of what you can see in each visualization, but you didn't tie this into the similarities / differences with histograms. Can you see the minimum and maximum in a histogram? Can you see outliers in a histogram?  
</div>

<div style="color:blue">
Overall: 3
</div>


## LAX Destinations 

If you want to visualize only on delays of flights headed to Los Angeles, you need to first `filter()` the data for flights with that destination (`dest == "LAX"`) and then make a histogram of the departure delays of only those flights.

```{r}
lax_flights <- nycflights %>%
  filter(dest == "LAX")

ggplot(data = lax_flights, aes(x = dep_delay)) +
  geom_histogram()
```

Let's decipher these two commands (OK, so it might look like four lines, but the first two physical lines of code are actually part of the same command. It's common to add a break to a new line after `%>%` to help readability).

-   Command 1: Take the `nycflights` data frame, `filter()` for flights headed to LAX, and save the result as a new data frame called `lax_flights`.

    -   `==` means "if it's equal to".
    -   `LAX` is in quotation marks since it is a character string.

-   Command 2: Basically the same `ggplot()` call from earlier for making a histogram, except that it uses the smaller data frame for flights headed to LAX instead of all flights.

**Logical operators:** Filtering for certain observations (e.g. flights from a particular airport) is often of interest in data frames where we might want to examine observations with certain characteristics separately from the rest of the data.
To do so, you can use the `filter()` function and a series of **logical operators**.
The most commonly used logical operators for data analysis are as follows:

-   `==` means "equal to"
-   `!=` means "not equal to"
-   `>` or `<` means "greater than" or "less than"
-   `>=` or `<=` means "greater than or equal to" or "less than or equal to"


4. You learned in the tutorial that this process of creating a new dataset based on a filter is not necessarily the best plan. An alternative plan is to use the pipe operator (`%>%`) to create a data pipeline, carrying the filtered data into the plot. 
Change the code below, so it uses the pipe operator instead of saving a new dataset. 

```{r}
## For this exercise, you need to change the code below! 

nycflights %>%
  filter(dest == "LAX") %>%
ggplot(aes(x = dep_delay)) +
  geom_histogram()
```

<div style="color:blue">
Great use of the pipe operator!
</div>

<div style="color:blue">
Overall: 4
</div>


### Multiple Data Filters 

You can also filter based on multiple criteria.
Suppose you are interested in flights headed to San Francisco (SFO) in February:

```{r}
sfo_feb_flights <- nycflights %>%
  filter(dest == "SFO", month == 2)
```

Note that you can separate the conditions using commas if you want flights that are both headed to SFO **and** in February.
If you are interested in either flights headed to SFO **or** in February, you can use the `|` instead of the comma.


5.  Find the number of flights in this dataset that were headed to SFO in February. 
**Hint:** The `filter()` and `count()` functions will be helpful!  

```{r}
## Code for exercise 1 here! 
nycflights %>%
  filter(dest == "SFO", month == 2)
count(sfo_feb_flights)
## Not having a blank line between these two code tasks makes me think they are connected! 
## I would add a blank line between the different tasks in your code. 
```
There were 68 flights that were headed to SFO in February. 

<div style="color:blue">
Nice work! You didn't need to store the filtered data in a new dataset. If you used just a "plain" `count()` at the end, it would only output the 68 (because it is counting the rows in the dataset). 
</div>

<div style="color:blue">
Overall: 4
</div>

## Data Summaries 

You can also obtain numerical summaries for the flights headed to LAX, using the `summarise()` function:

```{r}
lax_flights %>%
  summarise(mean_dd   = mean(dep_delay), 
            median_dd = median(dep_delay), 
            n         = n())
```

Note that in the `summarise()` function you created a list of three different numerical summaries that you were interested in.
The names of these elements are user defined, like `mean_dd`, `median_dd`, `n`, and you can customize these names as you like (just don't use spaces in your names).
Calculating these summary statistics also requires that you know the summary functions you would like to use. 

**Summary statistics:** Some useful function calls for summary statistics for a single numerical variable are as follows:

-   `mean()`: calculates the average
-   `median()`: calculates the median
-   `sd()`: calculates the standard deviation
-   `var()`: calculates the variances
-   `IQR()`: calculates the inner quartile range (Q3 - Q1)
-   `min()`: finds the minimum 
-   `max()`: finds the maximum
-   `n()`: reports the sample size

Note that each of these functions takes a single vector as an argument and returns a single value.

## Data Summaries & Data Visualizations 

6.  Describe the distribution of the **arrival** delays of the LAX flights using a histogram and appropriate summary statistics.
**Hint:** The summary statistics you use should depend on the shape of the distribution.
<!-- Your response to this problem goes below this line! -->

To first make the histogram, data visualization, of the **arrival** delays of the LAX flights I tell R to look at the data from the lax_flights. Then I would pip this data into a ggplot with the aesthetics describing the x-axis. With in the ggplot function we have to spell out what the variable are to graph the geometric shape. In this case I am telling R to graph the x-axis as arrival delay in the histogram. And because the code above it already is piped into the second line R knows to only graph the arrival delay from LAX flights. After this I add a layer using the plus sign to specify that the graph I want is a histogram, represented in the first part of the third line. If wanted to make the histogram more visual and have it more rigid with more bars, I added the binwidth=5 within the geom_histogram function. However, when the binwidth is altered for a graph so is the distribution.
Whenever I see distribution I think statistics, such as mean, median, mode, sample size. Based off of my histogram the summary statistics I used are similar to the ones above. However, the numerical summaries for the flights headed to LAX was for arrival delay, not departure delay. I choose mean to point out the average arrival delay time as the graph is slightly skewed to the right. Based on the generated histogram it looks like there is a large variation or arrival times, which is why I wanted to specifically see the minimum and maximum.  And it is always nice to have sample size when running summary statistics because the larger the sample size the more precise our results. Once again I called for R to get its data from only the lax flights and piped that into the summarise function where the mean, minimum, maximum, and sample size were found. I named each summary statistic with an intuitive name and added _ad which stands for arrival delays. then within each statistic function I specified to use the variable arrival delay. Each statistic is added on with a comma to represent add.

<div style="color:blue">
Nice work! Great visualization and data summaries! I don't need long descriptions of what the code is doing, I would like to know what you see in the distribution instead. Excellent choice of data summaries for the min and max. For a skewed distribution what is an appropriate measure of center and spread? 
</div>

<div style="color:blue">
Overall: 3
</div>


```{r}
## Code for exercise 2 goes here! 
lax_flights %>%
ggplot(aes (x = arr_delay)) +
  geom_histogram()
lax_flights %>%
  summarise(mean_ad = mean(arr_delay), 
            min_ad = min(arr_delay),
            max_ad = max(arr_delay),
            sample_size         = n())
```

## Grouped Summaries 

Another useful technique is quickly calculating summary statistics for various groups in your data frame.
For example, we can modify the above command using the `group_by()` function to get the same summary stats for each origin airport:

```{r}
sfo_feb_flights %>%
  group_by(origin) %>%
  summarise(median_dd = median(dep_delay), 
            iqr_dd = IQR(dep_delay), 
            n_flights = n())
```

Here, we first grouped the data by `origin` and then calculated the summary statistics.

## Summaries vs. Visualizations 

Which month would you expect to have the highest average delay departing from an NYC airport?

Let's think about how you could answer this question. 
One option is to summarize the data and inspect the output. 
Another option is to plot the delays and inspect the plots. 
Let's try both! 

7. Find the average departure delays for each month, and arrange these average delays in descending order. 
**Hint:** the `desc()` function is helpful for arranging numbers in descending order! 

```{r}
## Code for exercise 3 goes here! 
nycflights %>%
  group_by(month)%>%
  summarise(mean_dd = mean(dep_delay))%>%
  arrange(desc(mean_dd))

```

<div style="color:blue">
Nice work combining all of these pieces together! Woohoo! Data rodeo! 
</div>

<div style="color:blue">
Overall: 4
</div>


8. Now, plot the distribution of departure delays, faceted by the month of departure. 
Choose the type of plot you believe is appropriate for visualizing the distribution of departure delays. 

```{r}
## Code for exercise 4 goes here! 
nycflights %>%
  ggplot(aes(x= dep_delay)) +
  geom_histogram(binwidth = 15) +
  facet_wrap(vars(month))
```

<div style="color:blue">
Nice work faceting by month and specifying a binwidth!  
</div>

<div style="color:blue">
Overall: 4
</div>


9. What information can you obtain from the visualization that you could not from the data summaries?   
<!-- Your response to this question goes below this line!  -->

There is a lot of information one can notice with data visualization, such as identifying possible patterns and trends. depending on the visualization things such as outliers, modality, shews, median, modes, minimums and maximum can be attained. It is also possible to present large amount of information to visualization and not require a whole lot of analyzing time. On the other hand, with data summaries there is more specific data presented so it may take a while to analyze. 
