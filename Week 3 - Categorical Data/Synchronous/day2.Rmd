---
title: "Plotting with ggplot2"
author: "Dr. Allison Theobold"
date: "September 28, 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---        

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# R options
options(
  htmltools.dir.version = FALSE,
  tibble.width = 65,
  width = 65
  )

# figure height, width, dpi
knitr::opts_chunk$set(fig.width = 8, 
                      fig.asp = 0.618,
                      out.width = "60%",
                      dpi = 300)

# fontawesome
htmltools::tagList(rmarkdown::html_dependency_font_awesome())

# magick
dev.off <- function(){
  invisible(grDevices::dev.off())
}

# xaringanExtra
library(xaringanExtra)
xaringanExtra::use_panelset()

library(emo)
library(palmerpenguins)
library(tidyverse)
library(flair)
```

```{r set-theme, include = FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color      = "#b76352", # mango
  secondary_color    = "#34605f", # bayberry
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  header_color = "#793540", #rhubarb
  white_color = "#F5F5F5", # lightest color
  black_color = "#36454F", # darkest color
  text_font_size = "30px", 
  link_color = "#696969" #grey
)
```

class: middle, center

.larger[**Warm-up**]

Fill in the associated data types (e.g. character, factor, integer, double) 
with each type of variable. 

	
| Variable    | Data Type in R |
|-------------|----------------|
| Categorical variable |       |	
| Continuous numerical variable | |
| Discrete numerical variable	  | |


---

class: inverse

.larger[.hand[ggplot2 first steps]]

```{r, fig.align='center', out.width = "50%"}
ggplot(data = mpg, mapping = aes(y = manufacturer)) + 
  geom_bar()
```

---

class: center, middle, inverse

.larger[A Plot of Layers]

```{r, echo = FALSE, out.width = "60%"}
knitr::include_graphics("images/layers.png")
```

---

.larger[Step 1: Start with the data]

```{r, fig.height = 5, fig.align='center'}
ggplot(data = mpg)
```

---

class: middle, center 

.larger[Step 2: <span style="color: red;">Map</span> variables to <span style="color: blue;">aes</span>thetics]

```{r aes, eval = FALSE, echo = FALSE}
ggplot(data = mpg, mapping = aes(y = manufacturer))
```

```{r, echo = FALSE}
decorate("aes", eval = FALSE) %>% 
  flair("aes", color = "blue") %>%
  flair("map", color = "red")
  
```

```{r, echo = FALSE, out.width = "40%"}
ggplot(data = mpg, mapping = aes(y = manufacturer))
```

---

class: middle, center

.larger[Step 3: Add <span style="color: purple;">(+)</span> <span style="color: blue;">geom</span>etric objects]

```{r add, eval = FALSE, echo = FALSE}
ggplot(data = mpg, mapping = aes(y = manufacturer)) + 
  geom_bar()
```

```{r, echo = FALSE}
decorate("add", eval = FALSE) %>% 
  flair("+", color = "purple") %>% 
  flair("geom_bar()", color = "blue")
```


---

class: middle, center, inverse

.larger[A reusable template

```
ggplot(data = <DATA>, mapping = aes(<MAPPINGS>)) + 
  <GEOM_FUNCTION>()
```

]

---

class: middle, center

.larger[.hand[What is an **aes**thetic?]]

---

.larger[An aesthetic is a visual property of the objects in your plot.]

</br>

>"You can convey information about your data by mapping the aesthetics in your
> plot to the variables in your dataset."

.large[
- variables on axes 
- size, shape, or the color of objects on plot
]

---

.larger[Axes]

<center>
```{r axes, eval = FALSE, echo = FALSE}
ggplot(data = mpg) + 
  geom_bar(mapping = aes(y = manufacturer)
)
```

```{r, echo = FALSE}
decorate_chunk(chunk_name = "axes", eval = FALSE) %>% 
  flair(pattern = "y = manufacturer", color = "blue")
```

</center>
</br> 

.large[
- Maps **`manufacturer`** to `r flair("y-axis", pattern = "y-axis", color = "blue")`
]

--

<center>
.rhubarb[.large[What do you expect the plot to look like?]]
</center>

---

class: middle, center

```{r, echo = FALSE, fig.align = 'center', out.width = "80%"}
ggplot(data = mpg) + 
  geom_bar(mapping = aes(y = manufacturer)
)
```

---

.larger[Axes - Part 2]

<center>
```{r axes2, eval = FALSE, echo = FALSE}
ggplot(data = mpg) + 
  geom_boxplot(mapping = aes(y = manufacturer, x = cty)
)
```

```{r, echo = FALSE}
decorate_chunk(chunk_name = "axes2", eval = FALSE) %>% 
  flair(pattern = "y = manufacturer", color = "blue") %>% 
  flair(pattern = "x = cty", color = "orange")
```

</center>
</br> 

.large[
- Maps **`manufacturer`** to `r flair("y-axis", pattern = "y-axis", color = "blue")`
- Maps **`cty`** to `r flair("x-axis", pattern = "x-axis", color = "orange")`
]

--

<center>
.rhubarb[.large[What do you expect the plot to look like?]]
</center>

---

class: middle, center

```{r, echo = FALSE, fig.align = 'center', out.width = "80%"}
ggplot(data = mpg) + 
  geom_boxplot(mapping = aes(y = manufacturer, x = cty)
)
```

---

.larger[Fill the Bars]

</br>

```{r, echo = FALSE}
mpg <- mpg %>% 
  mutate(cyl = as.factor(cyl))
```

```{r fill, eval = FALSE, echo = FALSE}
ggplot(data = mpg) + 
  geom_bar(mapping = aes(y = manufacturer, fill = cyl)
           )
```

```{r, echo = FALSE}
decorate_chunk(chunk_name = "fill", eval = FALSE) %>% 
  flair(pattern = "fill = cyl", color = "blue") 
```

--

<center>
.rhubarb[.large[What do you expect the plot to look like?]]
</center>

---

class: center, middle

```{r, fig.align='center', echo = FALSE, out.width = "80%"}
ggplot(data = mpg) + 
  geom_bar(mapping = 
             aes(y = manufacturer, 
                 fill = cyl)
           )
```

---

.larger[Don't Color the Bars]

```{r, echo = FALSE, out.width = "40%", fig.align='center'}
ggplot(data = mpg) + 
  geom_bar(mapping = 
             aes(y = manufacturer, 
                 color = cyl)
           )
```

```{r, eval = FALSE}
ggplot(data = mpg) + 
  geom_bar(mapping = 
             aes(y = manufacturer, 
                 color = cyl)
           )
```

---

class: center, middle, inverse

.larger[Piping]

![](images/pipe.png)

---

class: center, middle

.larger[Same Plot Two Ways]

**Option 1**

```{r, eval = FALSE}
ggplot(data = mpg, mapping = aes(y = manufacturer)) + 
  geom_bar()
```


**Option 2**
```{r, eval = FALSE}
mpg %>% 
ggplot(mapping = aes(y = manufacturer)) + 
  geom_bar()
```

--

.large[.rhubarb[What is the difference?]]

---

class: center, middle, inverse 

.larger[.hand[Your Turn]]

.large[Describe in your own terms what the pipe operator (%>%) does.] 