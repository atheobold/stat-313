---
title: "Stat 313 Final Day `r emo::ji('sad')`"
date: "December 2, 2021"
author: "Dr. Allison Theobold"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---


```{r, echo = FALSE, message = FALSE, warning = FALSE}
# R options
options(
  htmltools.dir.version = FALSE,
  tibble.width = 65,
  width = 65
  )

# figure height, width, dpi
knitr::opts_chunk$set(fig.width = 8, 
                      fig.asp = 0.618,
                      out.width = "60%",
                      dpi = 300, 
                      warning = FALSE, 
                      message = FALSE, 
                      fig.align = "center")

# fontawesome
htmltools::tagList(rmarkdown::html_dependency_font_awesome())

# magick
dev.off <- function(){
  invisible(grDevices::dev.off())
}

# xaringanExtra
library(xaringanExtra)
xaringanExtra::use_panelset()

library(xaringanthemer)
library(xaringan)
library(knitr)
library(tidyverse)
library(openintro)
library(moderndive)
library(infer)
library(ggridges)
library(flair)
library(broom)
library(gridExtra)
library(kableExtra)
library(emo)

options(show.signif.stars = FALSE)

movies <- movies_sample %>% 
  mutate(era = case_when(year < 1920 ~ "1910s", 
                         year >= 1920 & year < 1930 ~ "1920s", 
                         year >= 1930 & year < 1940 ~ "1930s", 
                         year >= 1940 & year < 1950 ~ "1940s", 
                         year >= 1950 & year < 1960 ~ "1950s", 
                         year >= 1960 & year < 1970 ~ "1960s", 
                         year >= 1970 & year < 1980 ~ "1970s", 
                         year >= 1980 & year < 1990 ~ "1980s", 
                         year >= 1990 & year < 2000 ~ "1990s", 
                         year >= 2000 ~ "2000s")) %>% 
  filter(era %in% c("1970s", "1980s", "1990s", "2000s"))
```

```{r set-theme, include = FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color      = "#b76352", # mango
  secondary_color    = "#34605f", # bayberry
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  header_color = "#793540", #rhubarb
  white_color = "#F5F5F5", # lightest color
  black_color = "#36454F", # darkest color
  text_font_size = "30px", 
  link_color = "#696969" #grey
)
```

class: middle, inverse, center

.larger[Two-way ANOVA] 

</br>

.hand[.larger[Goal]]

Assess if the relationship between one categorical explanatory variable
and the response .honey[differs] based on the values of another categorical
variable

---

class: middle, center

.huge[Modeling Options]


.larger[
.rhubarb[Additive Model]

.bayberry[Interaction Model] 

]
---

class: center

.bitlarger[**What are we looking for?**]

```{r, echo = FALSE, fig.align = 'center'}
movies %>% 
  ggplot(aes(x = era, y = rating, fill = genre)) + 
  geom_boxplot() +
  labs(x = "Era", 
       y = "IMDB Rating", 
       fill = "Genre") + 
  theme(axis.title = element_text(size = 18), 
        axis.text = element_text(size = 16), 
        legend.text = element_text(size = 16),
        legend.title = element_text(size = 18))
```

---

class: center

.bitlarger[**Slopes of Lines!**]

```{r, echo = FALSE, fig.align = 'center'}
means <- movies %>% 
  group_by(era, genre) %>% 
  summarize(mean_rating = mean(rating))


movies %>% 
  ggplot(aes(x = era, y = rating, fill = genre)) + 
  geom_boxplot() + 
  geom_segment(x = 0.55, y = means$mean_rating[1], 
               xend = 1.45, yend = means$mean_rating[2], 
               size = 2) + 
  geom_segment(x = 1.55, y = means$mean_rating[3], 
               xend = 2.45, yend = means$mean_rating[4], 
               size = 2) +
  geom_segment(x = 2.5, y = means$mean_rating[5],
               xend = 3.45, yend = means$mean_rating[6], 
               size = 2) +
  geom_segment(x = 3.55, y = means$mean_rating[7],
               xend = 4.45, yend = means$mean_rating[8], 
               size = 2) +
  labs(x = "Era", 
       y = "IMDB Rating", 
       fill = "Genre") + 
  theme(axis.title = element_text(size = 18), 
        axis.text = element_text(size = 16), 
        legend.text = element_text(size = 16),
        legend.title = element_text(size = 18))
```

---


.larger[Hypothesis Test Steps]


.large[Step 1: Fit an interaction model 

Step 2: Decide if the interaction is necessary  

- If yes, then this is your model! 
- If no, go to step 3.  
]

---

class: center, middle

```{r, echo = FALSE}
aov(rating ~ era*genre, data = movies) %>% 
  tidy() %>% 
  kable() %>% 
  kable_styling()
```

--

.large[**What would you decide?**]

---

.large[

Step 3: Fit an additive model 

Step 4: Decide if each explanatory variable is necessary 

]

```{r, echo = FALSE}
aov(rating ~ era + genre, data = movies) %>% 
  tidy() %>% 
  kable() %>% 
  kable_styling()
```

--

<center>

.large[**What would you decide?**]

