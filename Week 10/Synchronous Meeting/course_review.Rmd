---
title: "`r emo::ji('finish')` Two-way ANOVA & The Discipline of Statistics"
date: "March 10, 2021" 
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---

```{r set-theme, include=FALSE}
library(xaringanthemer)
library(xaringan)
library(knitr)
library(tidyverse)
library(openintro)
library(moderndive)
library(infer)
library(ggridges)
library(flair)
library(broom)
library(gridExtra)
library(kableExtra)

set.seed(12345)

knitr::opts_chunk$set(warning = FALSE, 
                       message = FALSE, 
                      fig.width = 5, 
                      fig.height = 4, 
                      results = "hold")

options(show.signif.stars = FALSE)

style_duo_accent(
  primary_color      = "#0F4C81", # pantone classic blue
  secondary_color    = "#B6CADA", # pantone baby blue
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  text_font_size     = "30px"
)

movies <- movies_sample %>% 
  mutate(era = case_when(year < 1920 ~ "1910s", 
                         year >= 1920 & year < 1930 ~ "1920s", 
                         year >= 1930 & year < 1940 ~ "1930s", 
                         year >= 1940 & year < 1950 ~ "1940s", 
                         year >= 1950 & year < 1960 ~ "1950s", 
                         year >= 1960 & year < 1970 ~ "1960s", 
                         year >= 1970 & year < 1980 ~ "1970s", 
                         year >= 1980 & year < 1990 ~ "1980s", 
                         year >= 1990 & year < 2000 ~ "1990s", 
                         year >= 2000 ~ "2000s")) %>% 
  filter(era %in% c("1970s", "1980s", "1990s", "2000s"))

```

class: middle, inverse

.huge-text[What is two-way ANOVA?]

---

.larger[ANOVA goal]

.large[
- Identify whether the means of groups are similar or different 

  - Compare how different a group of means are
  - Scale the differences relative to the variability of the groups
  - Summarize the differences with one number
]


---
class: middle

.large[**Movie Ratings**
]

```{r, echo = FALSE, fig.height = 7, fig.align='center', fig.width=10}
movies %>% 
  ggplot(aes(y = era, x = rating, fill = era)) + 
  geom_density_ridges(alpha = 0.8) + 
  scale_fill_brewer(palette = "Paired") + 
  labs(title = "Ratings Across Different Eras of Movies", 
       x = "IMDB Moving Rating") + 
  theme(legend.position = "none", 
        axis.text.y = element_text(size = 16), 
        axis.text.x = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title.x = element_text(size = 20))

```

---

class: inverse 

.large[**Model Hypotheses**] 

$H_0$: all of the group means are the same in the population 

* $\mu_{1970} = \mu_{1980} = \mu_{1990} = \mu_{2000}$

* There is no difference in the mean rating between different years, for all 
movies made between 1970 and 2009

</br> 

$H_A$: at least one of the means differs in the population 

* At least one $\mu_i$ differs  

* The mean movie rating for at least on era is different, for all movies made
between 1970 and 2009. 

---

.large[**To Permute or F it?**] 

To conduct a hypothesis test, you have two choices:  

1. permute the movie ratings assuming the null hypothesis is true 
2. use an F-distribution as an approximation to the null distribution 

</br> 

<center> 

Why would you choose one over the other? 

What is the difference in how you obtain your p-value? 

---
class: middle

.larger[Model Conclusions] 

```{r, echo = FALSE}
aov(rating ~ era, data = movies) %>% 
  tidy()
```

</br> 

**What would you conclude for the hypothesis test?** 

---

class: inverse 

.large[Multiple Comparison - Post Hoc]

If we reject $H_0$ in a one-way ANOVA, we may be interested in *which* means differ from each other. 

- Multiple comparisons allow for us to test all possible combinations of two means, to see which means differ. 

- Different from looking at a plot and deciding which means you want to compare!   

- Lots of hypothesis tests $\rightarrow$ increased Type I error rates 

  * Remedy with "family" $\alpha$ values 
  * Adjust p-values based on the number of tests performed   
  
---

class: inverse, center

.larger[**How do we account for a second variable?**]

---

class: middle, inverse

.larger[Two-way ANOVA] 

</br>
</br>

<center>

.hand[Goal]

Assess if the relationship between one categorical explanatory variable
and the response __*differs*__ based on the values of another categorical variable

---

class: middle 

.bitlarger[What does this look like?]

```{r, echo = FALSE, fig.width = 10, fig.height = 6, fig.align = 'center'}
movies %>% 
  ggplot(aes(y = era, x = rating)) + 
  geom_density_ridges(aes(fill = genre), alpha = 0.4) + 
  scale_fill_brewer(palette = "Paired") + 
  labs(title = "Ratings Across Different Eras of Movies", 
      x = "IMDB Moving Rating", 
       fill = "Movie Genre") + 
  theme(axis.text.y = element_text(size = 16), 
        axis.text.x = element_text(size = 16),
        plot.title = element_text(size = 20),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 16),
        axis.title.x = element_text(size = 20))
```


---

class: middle, inverse 

.larger[**Modeling Options**]


.bitlarger[
1. Additive Model

2. Interaction Model 

]
---

.bitlarger[**Additive Model**]

```{r, echo = FALSE, fig.width = 10, fig.height = 6, fig.align = 'center'}
means <- palmerpenguins::penguins %>% 
  mutate(year_cat = as.factor(year)) %>% 
  group_by(species, year_cat) %>% 
  filter(!is.na(flipper_length_mm)) %>% 
  summarize(mean_flipper = mean(flipper_length_mm))


palmerpenguins::penguins %>% 
  mutate(year_cat = as.factor(year)) %>% 
  ggplot(aes(x = species, y = flipper_length_mm, fill = year_cat)) + 
  geom_violin() + 
  geom_segment(x = 0.55, y = 187, xend = 1.45, yend = 192) + 
  geom_segment(x = 1.55, y = 192, xend = 2.45, yend = 198) +
  geom_segment(x = 2.5, y = 215, xend = 3.45, yend = 219) +
  theme(legend.position = "none") + 
  labs(x = "", 
       y = "") + 
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

---

.bitlarger[**Interaction Model**]

```{r, echo = FALSE, fig.width = 10, fig.height = 6, fig.align = 'center'}
means <- palmerpenguins::penguins %>% 
  mutate(year_cat = as.factor(year)) %>% 
  filter(!is.na(sex))  %>% 
  group_by(species, sex) %>% 
  filter(!is.na(flipper_length_mm)) %>% 
  summarize(mean_mass = mean(body_mass_g))

palmerpenguins::penguins %>% 
  filter(!is.na(sex)) %>% 
  ggplot(aes(x = species, y = body_mass_g, fill = sex)) + 
  geom_violin() + 
  geom_segment(x = 0.55, y = 3369, xend = 1.45, yend = 4043) + 
  geom_segment(x = 1.55, y = 3527, xend = 2.45, yend = 3939) +
  geom_segment(x = 2.55, y = 4680, xend = 3.45, yend = 5485) +
  theme(legend.position = "none") + 
  labs(x = "", 
       y = "") + 
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

---

## Hypothesis Test Steps 

.pull-left[
Step 1: Fit an interaction model 

Step 2: Decide if the interaction is necessary  

- If yes, then this is your model! 
- If no, go to step 3.  

```{r, echo = FALSE}
aov(rating ~ era*genre, data = movies) %>% 
  tidy()
```

]

.pull-right[

Step 3: Fit an additive model 

Step 4: Decide if each explanatory variable is necessary 

```{r, echo = FALSE}
aov(rating ~ era + genre, data = movies) %>% 
  tidy()
```
]

---

class: middle, inverse

.larger[The Discipline of Statistics]

---

class: middle, inverse

.large[The field of Statistics was developed to evaluate evidence obtained from data. Over the last century, the use of statistics has become embedded as a component of the scientific process for many disciplines.]

---

class: middle

.bitlarger[**Foundational ideas taught in statistics courses were invented by:**] 

- Francis Galton 
- Karl Pearson 
- Ronald Fisher

---

.large[**Eugenics & Statistics**]

</br> 

*Ideally, statisticians would like to divorce these tools from the lives and times of the people who created them. It would be convenient if statistics existed outside of history, but that's not the case. Statistics, as a lens through which scientists investigate real-world questions, has always been smudged by the fingerprints of the people holding the lens. Statistical thinking and eugenicist thinking are, in fact, deeply intertwined, and many of the theoretical problems with methods like significance testing—first developed to identify racial differences—are remnants of their original purpose, to support eugenics.*

[How Eugenics Shaped Statistics](https://nautil.us/issue/92/frontiers/how-eugenics-shaped-statistics)

---

.large[**Statistical Significance** -- The New "S" Word]

- "Significance, the new s-word, is overused and underdefined in the realm of connecting statistical results to the underlying science."

- "When used in statistics, significant does not mean important or meaningful, as it does in everyday speech."

- "I advocate a simple solution: Replace the s- word with words describing what you actually mean by it."


---

class: inverse

.large[**Moving to a World Beyond 0.05**]

- Accept & Acknowledge Uncertainty

- Be Thoughtful 

- Be Open

- Be Modest 