---
title: "Introduction to Multiple Linear Regression"
date: "October 18, 2021"
author: "Dr. Allison Theobold"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---


```{r, echo = FALSE, message = FALSE, warning = FALSE}
# R options
options(
  htmltools.dir.version = FALSE,
  tibble.width = 65,
  width = 65
  )

# figure height, width, dpi
knitr::opts_chunk$set(fig.width = 8, 
                      fig.asp = 0.618,
                      out.width = "60%",
                      dpi = 300, 
                      warning = FALSE, 
                      message = FALSE, 
                      fig.align = "center")

# fontawesome
htmltools::tagList(rmarkdown::html_dependency_font_awesome())

# magick
dev.off <- function(){
  invisible(grDevices::dev.off())
}

# xaringanExtra
library(xaringanExtra)
xaringanExtra::use_panelset()

library(emo)
library(tidyverse)
library(openintro)
library(ggridges)
library(flair)
library(flair)
library(broom)
library(gridExtra)
library(kableExtra)
library(png)
library(moderndive)

options(show.signif.stars = FALSE)
```

```{r set-theme, include = FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color      = "#b76352", # mango
  secondary_color    = "#34605f", # bayberry
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  header_color = "#793540", #rhubarb
  white_color = "#F5F5F5", # lightest color
  black_color = "#36454F", # darkest color
  text_font_size = "30px", 
  link_color = "#696969" #grey
)
```


.larger[Before...]

```{r, echo = FALSE}
births %>% 
  ggplot(mapping = aes(x = weeks, y = weight)) + 
  geom_jitter() + 
  geom_smooth(method = "lm") +
  labs(x = "Weeks of Gestation", 
       y = "Weight of Baby (lbs)")

```


---

.larger[Now...]

```{r, echo = FALSE, out.width = "70%"}
births %>% 
  ggplot(mapping = aes(x = weeks, y = weight, color = smoke)) + 
  geom_jitter() + 
  geom_smooth(method = "lm") +
  labs(x = "Weeks of Gestation", 
       y = "Weight of Baby (lbs)", 
       color = "Mother Smoking Status")
```

---

class: inverse, center, middle

.huge[.hand[How?]]

---

.larger[Step 1: Simple Linear Regression]

--

```{r, eval = FALSE}
weeks_lm <- lm(weight ~ weeks, data = births)

get_regression_table(weeks_lm)

```

```{r, echo = FALSE}
weeks_lm <- lm(weight ~ weeks, data = births)

get_regression_table(weeks_lm) %>% 
  select(term:std_error)

```


---

class: inverse, middle

.larger[Step 2: Offsets!]

```{r, eval = FALSE}
smoke_lm <- lm(weight ~ weeks * smoke, data = births)

get_regression_table(smoke_lm)

```

```{r, echo = FALSE}
smoke_lm <- lm(weight ~ weeks * smoke, data = births)

get_regression_table(smoke_lm) %>% 
  select(term:std_error)
```


