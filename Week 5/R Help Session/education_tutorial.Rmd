---
title: "Data Wrangling and Visualization with Educational Data"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include = FALSE}
library(tidyverse)
library(moderndive)
library(broom)

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

hsb2 <- hsb2 %>% 
  rename(sex = gender)
```

## Welcome

The dataset that we will work with in this tutorial comes from the High School and Beyond Survey, which is a survey conducted on high school seniors by the National Center of Education Statistics.

### Variables in `hsb2`

Let's take a moment to go through the variables in the High School and Beyond dataset:

```{r glimpse-hsb2-again, echo=TRUE}
glimpse(hsb2)
```

## Summarizing Data

Creating summary tables of observations is a nice way to present an overview of a dataset. This can take a variety of forms: 

1. summary tables of a single categorical variable
2. summary tables of two categorical variables
3. summary tables of the summary statistics for quantitative variables

Let's try these out! 

First, let's summarize the number of observations for each race in the dataset. 

```{r sum-cat, exercise = TRUE, exercise.eval = FALSE}
hsb2 %>% 
  count(race, sort = TRUE)
  
```

**Bonus:** How would you change the table to be in descending order? 

Next, let's summarize the number of observations for each race and socioeconomic status in the dataset. 

```{r sum-2cat, exercise = TRUE, exercise.eval = FALSE}
hsb2 %>% 
  count(race, ses) %>% 
  arrange(n)

```

**Bonus:** How would you change the table to be in ascending order? 

Finally, let's summarize the median of the reading and math tests. 

```{r sum-num, exercise = TRUE, exercise.eval = FALSE}
hsb2 %>% 
  group_by(race) %>% 
  summarize(read_median = median(read), 
            median(math), 
            max(read), 
            max(math)) %>% 
  arrange(read_median)

```


## Visualizing Numerical Data

The most logical and most useful first step of any data analysis is an exploratory analysis. And a very important and informative component of exploratory data analysis is visualization.

First, let's start by visualizing the relationship between the math and science scores of the students in the High School and Beyond dataset.

```{r hsb2-science-math, exercise = TRUE, exercise.eval = FALSE}
hsb2 %>% 
  ggplot(aes(x = science, y = math)) + 
  geom_point() +
  geom_smooth(method = "lm")
```

### Visualizing Numerical & Categorical Data

Let's plot the same math and science test scores, but this time let's also consider the race that the student is: white, asian, hispanic, and african american. 

- Add a linear regression line for each race! 
- Turn the standard error bands off, so you can more easily see each line. 

```{r hsb2-science-math-prog, exercise = TRUE, exercise.eval = FALSE}
hsb2 %>% 
  ggplot(aes(x = science, y = math, color = race)) + 
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

```

What type of multiple linear regression model do you think we should fit? 

## Modeling Numerical & Categorical Data

Let's model the relationship between student's math scores and reading scores, allowing for the relationship to differ by race. 

Then inspect the regression to see how different the lines for each group are.

```{r model-science-math-race, exercise=TRUE, exercise.eval = FALSE}
# Fit a linear regression model with different slopes 

math_sci_lm <- lm(math ~ science + race + science:race, data = hsb2)

get_regression_table(math_sci_lm)

```

For African American students the regression line is: 
hat(math) = 34.126 + 0.295*science

hat(y) = b_0 + b_1 * x

For Asian students: 
hat(math) = 34.126 -15.221 + 0.295 * science + 0.451 * science
hat(math) = 18.905 + 0.746 * science

## Visualizing Model Conditions 

```{r}

model_name_info <- 

```

